name: Unit Tests

on:
  pull_request:
    branches: [ main ]
    paths:
      - 'src/**'
      - 'test/lib/**'
      - 'test/react-components/**'
  push:
    branches: [ main ]
    paths:
      - 'src/**'
      - 'test/lib/**'
      - 'test/react-components/**'
  workflow_dispatch: # Allow manual triggering

jobs:
  unit-tests:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
      
    - name: Setup Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '18'
        
    - name: Clean and install dependencies
      run: |
        rm -rf node_modules package-lock.json
        npm install
        
    - name: Verify project structure
      run: |
        echo "ğŸ“ Checking project structure..."
        ls -la
        echo "ğŸ“ Checking src directory..."
        ls -la src/
        echo "ğŸ“ Checking test directories..."
        ls -la test/
        ls -la test/lib/
        ls -la test/react-components/
        
    - name: Run unit tests
      run: |
        echo "ğŸ§ª Running unit tests with auto-discovery..."
        npm test  
        
    - name: Success message
      if: success()
      run: |
        echo "âœ… All unit tests passed successfully!"
        echo "ğŸ¯ Components and libraries are working correctly."
